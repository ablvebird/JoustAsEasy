<?xml version="1.0" encoding="UTF-8"?>
<!--
    persistence.xml

    This file configures the persistence layer of the application using the Jakarta Persistence API.
    It defines the persistence unit, database connection properties, and Hibernate-specific settings.

    The database used here is H2, which is a lightweight, file-based database.
    Hibernate is the ORM (Object-Relational Mapping) framework used to interact with the database.
-->
<persistence xmlns="https://jakarta.ee/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="https://jakarta.ee/xml/ns/persistence https://jakarta.ee/xml/ns/persistence/persistence_3_0.xsd"
             version="3.0">

    <!--
        <persistence-unit>

        The persistence unit defines a logical grouping of all entity classes and configurations
        related to the database connection, transaction handling, and persistence provider (Hibernate in this case).
        The 'transaction-type' is set to RESOURCE_LOCAL, meaning transaction management is handled by the application.

        - name: "joustAsEasyPU" refers to the unique name of this persistence unit.
        - transaction-type: RESOURCE_LOCAL means transactions will be managed by the application, not by a container.
    -->
    <persistence-unit name="joustAsEasyPU" transaction-type="RESOURCE_LOCAL">

        <!-- Entity class mappings -->
        <class>org.app.entities.House</class>
        <class>org.app.entities.Character</class>
        <class>org.app.entities.Bout</class>

        <!-- Properties block: These properties configure the database connection and Hibernate behavior. -->
        <properties>

            <!-- Database connection settings for H2 -->
            <!--
                jdbc.url: The URL to connect to the H2 database.
                The AUTO_SERVER=TRUE option enables H2's server mode so multiple connections can access the database.
                DB_CLOSE_DELAY=-1 keeps the in-memory database available after the connection is closed.
            -->
            <property name="jakarta.persistence.jdbc.url" value="jdbc:h2:file:~/data/joustAsEasyDb;AUTO_SERVER=TRUE;DB_CLOSE_DELAY=-1"/>

            <!-- Database credentials (used with H2) -->
            <property name="jakarta.persistence.jdbc.user" value="admin"/>
            <property name="jakarta.persistence.jdbc.password" value="1234"/>

            <!-- Database driver (H2) -->
            <property name="jakarta.persistence.jdbc.driver" value="org.h2.Driver"/>

            <!-- Hibernate-specific settings -->
            <!--
                hibernate.dialect: Defines the dialect that Hibernate uses to generate appropriate SQL for the database.
                hbm2ddl.auto: This automatically generates the schema.
                  - 'create-drop' means the schema will be created when the session factory is initialized and dropped when the session is closed.
                show_sql: Enables logging of SQL statements generated by Hibernate.
                format_sql: Formats the generated SQL to make it more readable in the logs.
                highlight_sql: Highlights SQL syntax in the console for easier debugging.
            -->
            <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect"/>
            <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
            <property name="hibernate.show_sql" value="true"/>
            <property name="hibernate.format_sql" value="true"/>
            <property name="hibernate.highlight_sql" value="true"/>

        </properties>
    </persistence-unit>
</persistence>
